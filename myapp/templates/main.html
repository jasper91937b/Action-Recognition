<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    
    <title>居家看護系統</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <style>
        th,td {
            width: 150px;
        }
    </style>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
   
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    
    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container-fluid">
        <div class="row bg-light text-white" >
            <div class="col-md-12 ">
                <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-dark bg-dark">
                     
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="navbar-toggler-icon"></span>
                    </button> <a class="navbar-brand" href="http://127.0.0.1:8000/">首頁</a>
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="navbar-nav">
                            <li class="nav-item dropdown">
                                 <a class="nav-link dropdown-toggle" href="http://example.com" id="navbarDropdownMenuLink" data-toggle="dropdown">居家智能辨識系統</a>
                                <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                    <a class="dropdown-item">門禁系統</a> 
                                    <a class="dropdown-item" href="http://127.0.0.1:8000/action/predict/">居家看護系統</a> 
                                    <a class="dropdown-item">物件辨識</a>
                                </div>
                            </li>
                        </ul>
                        <form class="form-inline">
                            <input class="form-control mr-sm-2" type="text" /> 
                            <button class="btn btn-primary my-2 my-sm-0" type="submit">
                                Search
                            </button>
                        </form>
                        <ul class="navbar-nav ml-md-auto">
                            <li class="nav-item active" style="color: aliceblue;">
                            </li>
                        </ul>
                    </div>
                </nav>

            </div>
        </div>
        <div class="page-header" style="text-align:center">
            <p></p>
            <h2>居家看護系統</h2>
        </div>
    </div> 
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-6">
                <table class="table table-hover"style="position:absolute;top:70px;left:50px;width:550px">
                    <thead class='table-dark'>
                        <tr>
                            <th>
                                Person
                            </th>
                            <th>
                                Action
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="table1">
                        </tr>
                        <tr> 
                            <td id ="loglist">
                            </td>
                        </tr>
                    </tbody>
                </table>
               
            </div>
        </div> 
    </div>
    
    <div style="position:absolute;left:50px;top:150px"> 
    <form method="post" action="http://localhost:8000/action/predict/" enctype="multipart/form-data">
        {% csrf_token %} 
        <!-- {{ form.as_p }} -->
        <input id="file" name="file" type="file" class="btn btn-secondary btn-md active">   
        <button onclick="location.href = 'http://localhost:8000/action/predit/'" type="submit" id="Savebutton" class="btn btn-secondary btn-md active">Save</button>
        
    </form>
    
    </div>
 
    <script>
        var str =""
        function getdetail() {
           $.ajax({
                type: "GET",
                url: "http://localhost:8000/action/send_data/",
                success: function(result) {
                    var table
                    var date = new Date()
                    $.each(result.data , function(key, value){
                       table += "<td>" + key +"</td><td>"+value+"</td>";
                    })
                    $("#table1").html(table);
                    
                    if (result.showa == true ){
                        str += "<p>" + date + "已發出警告訊息"+"</p>"
                    } 
                    if (result.showh == true) {
                        str += "<p>" + date + "已發出求救訊息"+"</p>"
                    }
                    if (result.showo == true){
                        str += "<p>" + date + "已發出確認隨身物品訊息"+"</p>"
                   }
                   $("#loglist").html(str);
                },
                error: function () {
                   alert("error")
                }
           })
       }
       setTimeout(function(){
          $("#Savebutton").mouseup(function() {
             setInterval(function() { getdetail();}, 1000)
          }) 
       }, 3000)
    </script>
       
</body>

</html>
